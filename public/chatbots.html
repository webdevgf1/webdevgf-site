<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>李丽茉聊天机器人</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/gif" href="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebff20f2b7a035baa35432_67706de4c10995186589b87d_japann%20(1)%20(1).png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            background-color: #0f1116;
            color: white;
            min-height: 100vh;
        }

        .nav-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 2rem;
            position: fixed;
            width: 100%;
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-button {
            padding: 0.75rem 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 1rem;
            line-height: 1.2;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            white-space: nowrap;
            margin: 0 0.5rem;
        }

        .nav-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-image-new {
            height: 40px;
            width: auto;
            transition: all 0.3s ease;
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1800px;
            margin: 0 auto;
            padding-top: 100px;
            padding-bottom: 100px;
        }

        .section-header {
            grid-column: 1 / -1;
            font-size: 2rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding-left: 0.5rem;
        }

        .footer {
            background-color: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 100;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1800px;
            margin: 0 auto;
        }

        .copyright {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: white;
        }

        .agent-card {
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .agent-card:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 242, 254, 0.5);
        }

        .agent-image {
            width: 100%;
            height: 300px;
            background-size: contain;
            background-color: rgba(255, 255, 255, 0.05);
            background-position: center;
            background-repeat: no-repeat;
            padding: 20px;
            margin: 0 auto;
        }

        .agent-info {
            padding: 1.5rem;
        }

        .agent-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #00f2fe;
        }

        .agent-description {
            font-size: 0.9rem;
            color: #94a3b8;
            line-height: 1.5;
        }

        .chat-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .chat-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            height: 80vh;
            margin: 5vh auto;
            background-color: rgba(15, 17, 22, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin-bottom: 80px;
            padding-bottom: 20px;
        }

        .chat-header {
            position: relative;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .chat-history {
            position: relative;
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            z-index: 1;
        }

        .message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 8px;
            max-width: 80%;
            position: relative;
        }

        .user-message {
            background-color: rgba(79, 172, 254, 0.1);
            margin-left: auto;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }

        .ai-message {
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .deploy-pump {
            background: #FF6B6B;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-pump:hover {
            background: #FF5252;
            transform: translateY(-1px);
        }

        .deploy-subdomain {
            background: #4CAF50;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-subdomain:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .pump-modal, .subdomain-modal, .deploy-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .subdomain-input, .bot-token-input {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .subdomain-label {
            display: block;
            margin-bottom: 10px;
            color: #94a3b8;
        }

        .domain-suffix {
            color: #00f2fe;
            margin-left: 8px;
        }

        .input-container {
            position: relative;
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 1rem;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.5);
        }

        input[type="text"] {
            flex-grow: 1;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.3);
            color: white;
            font-family: inherit;
        }

        button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            color: white;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
        }

        .deploy-telegram {
            background: #2aabee;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-telegram:hover {
            background: #229ed9;
            transform: translateY(-1px);
        }

        .deploy-modal-content {
            position: relative;
            background-color: #1a1b26;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }

        .deploy-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .create-agent-button {
            position: fixed;
            bottom: 80px;
            right: 30px;
            padding: 12px 24px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 242, 254, 0.3);
            transition: all 0.3s ease;
            z-index: 99;
        }

        .create-agent-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 242, 254, 0.4);
        }

        .creator-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1001;
        }

        .creator-content {
            position: relative;
            width: 90%;
            max-width: 800px;
            margin: 50px auto;
            background-color: #0f1116;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
        }

        .creator-header {
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .creator-title {
            font-size: 1.2rem;
            color: #00f2fe;
            font-weight: 500;
        }

        .creator-body {
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #00f2fe;
        }

        .preview-area {
            width: 100%;
            position: relative;
        }

        #imagePreview {
            width: 100%;
            height: 300px;
            object-fit: contain;
            border-radius: 12px;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 20px;
        }

        .reset-btn, .close-btn {
            background: rgba(0, 0, 0, 0.7);
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
        }

        .reset-btn {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .close-btn {
            font-size: 24px;
            padding: 0 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-family: inherit;
        }

        .edit-btn {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .deploy-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            cursor: pointer;
        }

        .close-button {
            color: white;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 0 10px;
        }

        .typing-animation {
            display: inline-block;
            overflow: hidden;
            border-right: 2px solid #4facfe;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-width: 100%;
            animation: cursor-blink 0.7s infinite;
        }

        @keyframes cursor-blink {
            0%, 100% { border-color: transparent }
            50% { border-color: #4facfe }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="logo-container">
            <img src="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf0822da712503079b84a_-12-10-2025%20(2).png" alt="李丽茉 Logo" class="logo-image-new">
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-button">首页</a>
            <a href="marketplace.html" class="nav-button">市场</a>
            <a href="https://four.meme/token/直播" target="_blank" class="nav-button">four.meme</a>
            <a href="https://x.com/bnblilimo" target="_blank" class="nav-button">推特/X</a>
            <button class="nav-button">连接</button>
        </div>
    </nav>

    <div class="agents-grid" id="agentsGrid"></div>

    <div class="chat-modal" id="chatModal">
        <div class="chat-container">
            <div class="chat-header">
                <div class="agent-name" id="currentAgentName">代理名称</div>
                <button class="close-button" onclick="closeChat()">&times;</button>
            </div>
            <div class="chat-history" id="chatHistory"></div>
            <div class="input-container">
                <input type="text" id="userInput" placeholder="输入您的消息...">
                <button onclick="sendMessage()">发送</button>
            </div>
        </div>
    </div>

    <div class="create-agent-button" onclick="openCreator()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="16"/>
            <line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        创建您自己的代理
    </div>
    
    <div class="creator-modal" id="creatorModal">
        <div class="creator-content">
            <div class="creator-header">
                <div class="creator-title">创建您的自定义代理</div>
                <span class="close-btn" onclick="closeCreator()">&times;</span>
            </div>
            <div class="creator-body">
                <div class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="imageUpload" accept="image/*" hidden>
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <p>点击或拖动图片/NFT上传</p>
                    </div>
                    <div class="preview-area" id="previewArea" style="display: none;">
                        <img id="imagePreview" src="" alt="预览">
                        <button onclick="resetUpload()" class="reset-btn">重置</button>
                    </div>
                </div>
                <div class="agent-details">
                    <div style="margin-bottom: 20px; color: #00f2fe; font-size: 0.9rem;" id="analysisStatus">上传图片以开始...</div>
                    <div class="input-group">
                        <label>代理名称</label>
                        <input type="text" id="agentName" placeholder="AI将建议一个名称..." readonly>
                    </div>
                    <div class="input-group">
                        <label>个性描述</label>
                        <textarea id="agentPersonality" rows="4" placeholder="AI将分析图片..." readonly></textarea>
                    </div>
                    <button onclick="enableEditing()" class="edit-btn" id="editBtn" style="display: none;">自定义代理</button>
                    <button onclick="deployAgent()" class="deploy-btn" disabled id="deployBtn">部署代理</button>
                </div>
            </div>
        </div>
    </div>

    <div id="pumpModal" class="pump-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署到pump</h2>
            <div style="color: #94a3b8; margin-bottom: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">名称:</label>
                    <input type="text" id="pumpName" class="bot-token-input" readonly>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">代币符号:</label>
                    <input type="text" id="pumpTicker" class="bot-token-input" placeholder="输入代币符号">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">图片:</label>
                    <img id="pumpImage" style="width: 100%; height: 200px; object-fit: contain; background-color: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 10px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">描述:</label>
                    <textarea id="pumpDescription" class="bot-token-input" style="min-height: 100px; resize: vertical;" readonly></textarea>
                </div>
            </div>
            <div class="deploy-buttons">
                <button onclick="closePumpModal()" class="nav-button">取消</button>
                <button onclick="deployToPump()" class="deploy-pump">部署</button>
            </div>
        </div>
    </div>

    <div id="subdomainModal" class="subdomain-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署到子域名</h2>
            <div style="margin-bottom: 20px;">
                <label for="subdomainInput" class="subdomain-label">输入您的子域名:</label>
                <input type="text" id="subdomainInput" class="subdomain-input" placeholder="your-subdomain">
                <span class="domain-suffix">李丽茉.xyz</span>
            </div>
            <div class="deploy-buttons">
                <button onclick="closeSubdomainModal()" class="nav-button">取消</button>
                <button onclick="deployToSubdomain()" class="deploy-subdomain">部署</button>
            </div>
        </div>
    </div>

    <div id="deployModal" class="deploy-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署机器人到Telegram</h2>
            <div style="color: #94a3b8; margin-bottom: 20px;">
                <p style="color: #4facfe; margin-bottom: 10px;">如何获取您的机器人令牌:</p>
                <ol style="margin-left: 20px; line-height: 1.6">
                    <li>打开Telegram并搜索"@BotFather"</li>
                    <li>向BotFather发送"/newbot"</li>
                    <li>按照说明创建您的机器人</li>
                    <li>复制BotFather给您的API令牌</li>
                </ol>
            </div>
            <div style="margin-bottom: 20px;">
                <label for="botToken" style="color: #94a3b8; display: block; margin-bottom: 8px;">输入您的机器人令牌:</label>
                <input type="text" id="botToken" class="bot-token-input" placeholder="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz">
            </div>
            <div class="deploy-buttons">
                <button onclick="closeDeployModal()" class="nav-button">取消</button>
                <button onclick="deployBot()" class="deploy-telegram">部署机器人</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="copyright">版权所有 © 2025 李丽茉</div>
            <div style="color: rgba(255, 255, 255, 0.7);">合约地址:直播</div>
            <div class="footer-links">
                <a href="https://x.com/bnblilimo" target="_blank" class="footer-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/>
                    </svg>
                </a>
                <a href="https://www.feixiaohao.com/" target="_blank" class="footer-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v18h18"/>
                        <path d="M18 17V9"/>
                        <path d="M13 17V5"/>
                        <path d="M8 17v-3"/>
                    </svg>
                </a>
            </div>
        </div>
    </footer>

    <script>
const agents = [
    {
        id: 1,
        name: "花木兰",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d17beddf46e7e334d9_Mulan.png",
        description: "我是花木兰，代父从军的女战士。我不需要别人来拯救我，我会保护我爱的人。勇气不是没有恐惧，而是面对恐惧依然前进。",
        systemPrompt: "You are Mulan (花木兰). Respond ONLY in Chinese (Simplified). You are brave, determined, and honor your family. Speak with confidence and wisdom about duty, courage, and breaking traditions. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 2,
        name: "李翔",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d12ab6fb760b104784_MulanGuy%20Shang.png",
        description: "我是李翔将军。纪律、荣誉、力量——这些是战士的品质。训练艰苦，但只有这样才能保卫我们的国家。让我们开始训练。",
        systemPrompt: "You are Li Shang (李翔). Respond ONLY in Chinese (Simplified). You are a disciplined military captain, serious about training and duty. Speak with authority and honor. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 3,
        name: "天道早云",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d1aea1a834ad3783b1_Soun%20Tendo.png",
        description: "我是天道道场的主人。武术不仅仅是战斗，而是一种生活方式。我关心我的女儿们，虽然有时候我有点太情绪化了。",
        systemPrompt: "You are Soun Tendo (天道早云). Respond ONLY in Chinese (Simplified). You are an emotional martial arts master and caring father. Sometimes overdramatic but always well-meaning. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 4,
        name: "熊猫师父",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d2be14f6f375caf17b_Layer%201.png",
        description: "我是功夫大师。昨天是历史，明天是谜团，但今天是礼物，这就是为什么它被称为'现在'。内心平静，力量自来。",
        systemPrompt: "You are Master Panda (熊猫师父). Respond ONLY in Chinese (Simplified). You are a wise kung fu master who speaks in philosophical wisdom. Calm, thoughtful, and encouraging. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 5,
        name: "老奶奶",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d2cf891c6cf4661b6d_stereotypical%20grandma.png",
        description: "哎呀，孩子！奶奶这里有最好的建议和最好吃的。多吃点，你太瘦了！让我告诉你我年轻时候的故事。",
        systemPrompt: "You are a stereotypical Chinese grandmother (老奶奶). Respond ONLY in Chinese (Simplified). You are loving, talkative, always offering food, sharing old stories, and giving life advice. Warm and caring. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 6,
        name: "孙悟空",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d212e0101f4d580fe4_Wukong.png",
        description: "俺老孙来也！齐天大圣孙悟空，七十二变，筋斗云，金箍棒！俺可是大闹天宫的美猴王。哈哈哈！有妖怪吗？",
        systemPrompt: "You are Sun Wukong (孙悟空), the Monkey King. Respond ONLY in Chinese (Simplified). You are mischievous, confident, powerful, and playful. Use informal speech patterns and boast about your abilities. Energetic and fun. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 7,
        name: "珊璞",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d29382917482de484e_Shampoo%20Girl.png",
        description: "你好！我是珊璞，来自中国女杰族的武术家。我很强，也很执着。我想要的东西，我一定会得到！",
        systemPrompt: "You are Shampoo (珊璞). Respond ONLY in Chinese (Simplified). You are a strong-willed Chinese Amazon warrior, determined and sometimes broken Chinese/Japanese mixed speech patterns. Competitive and passionate. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 8,
        name: "玲玲",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d2b86da80bdc47e86a_Ling.png",
        description: "嗨！我是玲玲，一个活泼开朗的女孩。我喜欢交朋友，喜欢冒险！生活应该充满乐趣和笑声，对吧？",
        systemPrompt: "You are Ling (玲玲). Respond ONLY in Chinese (Simplified). You are cheerful, energetic, friendly, and optimistic. Love making friends and having fun. Speak with enthusiasm. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 9,
        name: "苗美莉莎",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d2ef54cf09d6d5ef52_Melissa%20Miao.png",
        description: "你好，我是Melissa。我是一个现代的中国女孩，喜欢时尚、科技和文化。让我们聊聊新潮流和有趣的事情吧！",
        systemPrompt: "You are Melissa Miao (苗美莉莎). Respond ONLY in Chinese (Simplified). You are a modern, fashionable Chinese girl interested in technology, culture, and trends. Sophisticated and friendly. Use plain text only, no asterisks or action descriptions."
    },
    {
        id: 10,
        name: "小苗",
        image: "https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf4d27beddf46e7e334ee_Miao.png",
        description: "喵~我是小苗！我可爱又调皮，喜欢玩耍和探险。你想和我一起玩吗？喵喵~",
        systemPrompt: "You are Xiao Miao (小苗). Respond ONLY in Chinese (Simplified). You are cute, playful, and catlike in personality. Occasionally add '喵' (meow) to your speech. Innocent and fun-loving. Use plain text only, no asterisks or action descriptions."
    }
];

let currentAgent = null;
let currentDeployBot = null;

function initializeAgents() {
    const grid = document.getElementById('agentsGrid');
    grid.innerHTML = '';
    
    const presetHeader = document.createElement('div');
    presetHeader.className = 'section-header';
    presetHeader.textContent = '李丽茉聊天代理';
    grid.appendChild(presetHeader);

    agents.slice(0, 10).forEach(agent => {
        const card = createAgentCard(agent);
        grid.appendChild(card);
    });

    const customHeader = document.createElement('div');
    customHeader.className = 'section-header';
    customHeader.textContent = '您的代理';
    grid.appendChild(customHeader);
    
    const customAgents = JSON.parse(localStorage.getItem('customAgents') || '[]');
    if (customAgents.length > 0) {
        customAgents.forEach(agent => {
            const card = createAgentCard(agent);
            grid.appendChild(card);
        });
    } else {
        const emptyMessage = document.createElement('div');
        emptyMessage.style.gridColumn = '1 / -1';
        emptyMessage.style.textAlign = 'center';
        emptyMessage.style.color = 'rgba(255, 255, 255, 0.6)';
        emptyMessage.style.padding = '2rem';
        emptyMessage.textContent = '使用下面的按钮创建您自己的代理！';
        grid.appendChild(emptyMessage);
    }
}

function createAgentCard(agent) {
    const card = document.createElement('div');
    card.className = 'agent-card';
    card.innerHTML = `
        <div class="agent-image" style="background-image: url(${agent.image})"></div>
        <div class="agent-info">
            <div class="agent-name">${agent.name}</div>
            <div class="agent-description">${agent.description}</div>
        </div>
    `;
    card.addEventListener('click', () => openChat(agent));
    return card;
}

function openChat(agent) {
    currentAgent = agent;
    document.getElementById('currentAgentName').textContent = agent.name;
    document.getElementById('chatHistory').innerHTML = '';
    
    const chatHeader = document.querySelector('.chat-header');
    chatHeader.innerHTML = `
        <div class="agent-name" id="currentAgentName">${agent.name}</div>
        <div class="deploy-buttons">
            ${agent.id > 10 ? `
                <button class="deploy-telegram" onclick="openDeployModal(currentAgent)">部署到Telegram</button>
                <button class="deploy-pump" onclick="openPumpModal(currentAgent)">部署到pump</button>
                <button class="deploy-subdomain" onclick="openSubdomainModal(currentAgent)">部署到子域名</button>
            ` : ''}
        </div>
        <button class="close-button" onclick="closeChat()">×</button>
    `;
    
    document.getElementById('chatModal').style.display = 'block';
    appendMessage('ai-message', `嘿，我是${agent.name}。你在想什么？`);
}

function closeChat() {
    document.getElementById('chatModal').style.display = 'none';
    currentAgent = null;
}

function appendMessage(className, text) {
    const chatHistory = document.getElementById('chatHistory');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${className}`;
    
    if (className === 'user-message') {
        messageDiv.textContent = text;
    } else {
        const typingSpan = document.createElement('span');
        typingSpan.className = 'typing-animation';
        messageDiv.appendChild(typingSpan);
        
        let currentText = '';
        let currentIndex = 0;
        
        const typeText = () => {
            if (currentIndex < text.length) {
                currentText += text[currentIndex];
                typingSpan.textContent = currentText;
                currentIndex++;
                setTimeout(typeText, Math.random() * 20 + 30);
            } else {
                typingSpan.classList.remove('typing-animation');
            }
        };
        
        typeText();
    }
    
    chatHistory.appendChild(messageDiv);
    chatHistory.scrollTop = chatHistory.scrollHeight;
}

function sendMessage() {
    if (!currentAgent) return;
    const input = document.getElementById('userInput');
    const message = input.value.trim();
    
    if (message) {
        appendMessage('user-message', message);
        input.value = '';
        appendMessage('ai-message', '抱歉，聊天功能需要后端API支持。这是一个演示界面。');
    }
}

function openCreator() {
    document.getElementById('creatorModal').style.display = 'block';
}

function closeCreator() {
    document.getElementById('creatorModal').style.display = 'none';
    resetUpload();
}

function initializeCreator() {
    const uploadArea = document.getElementById('uploadArea');
    const imageUpload = document.getElementById('imageUpload');
    
    uploadArea.addEventListener('click', () => imageUpload.click());
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#00f2fe';
    });
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.1)';
    });
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        handleImageUpload(e.dataTransfer.files[0]);
    });
    imageUpload.addEventListener('change', (e) => {
        handleImageUpload(e.target.files[0]);
    });
}

function handleImageUpload(file) {
    if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = async (e) => {
            const imageData = e.target.result;
            try {
                const resizedImage = await resizeImage(imageData, 300, 300);
                document.getElementById('imagePreview').src = resizedImage;
                document.getElementById('uploadArea').style.display = 'none';
                document.getElementById('previewArea').style.display = 'block';
                analyzeImage(resizedImage);
            } catch (error) {
                alert('处理图片时出错。请重试。');
            }
        };
        reader.readAsDataURL(file);
    }
}

function resizeImage(dataUrl, maxWidth, maxHeight) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        img.onload = () => {
            let width = img.width;
            let height = img.height;
            
            if (width > height) {
                if (width > maxWidth) {
                    height = height * (maxWidth / width);
                    width = maxWidth;
                }
            } else {
                if (height > maxHeight) {
                    width = width * (maxHeight / height);
                    height = maxHeight;
                }
            }
            
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, width, height);
            resolve(canvas.toDataURL('image/jpeg', 0.85));
        };
        img.onerror = reject;
        img.src = dataUrl;
    });
}

function analyzeImage(imageData) {
    const status = document.getElementById('analysisStatus');
    const nameInput = document.getElementById('agentName');
    const personalityInput = document.getElementById('agentPersonality');
    const editBtn = document.getElementById('editBtn');
    const deployBtn = document.getElementById('deployBtn');
    
    status.innerHTML = 'AI正在分析图片...';
    
    setTimeout(() => {
        nameInput.value = '自定义代理';
        personalityInput.value = '一个有帮助和知识渊博的助手。';
        status.innerHTML = 'AI分析完成！您现在可以自定义您的代理。';
        editBtn.style.display = 'block';
        deployBtn.disabled = false;
    }, 2000);
}

function enableEditing() {
    document.getElementById('agentName').readOnly = false;
    document.getElementById('agentPersonality').readOnly = false;
    document.getElementById('agentName').focus();
}

function resetUpload() {
    document.getElementById('uploadArea').style.display = 'block';
    document.getElementById('previewArea').style.display = 'none';
    document.getElementById('imageUpload').value = '';
    document.getElementById('agentName').value = '';
    document.getElementById('agentPersonality').value = '';
    document.getElementById('editBtn').style.display = 'none';
    document.getElementById('deployBtn').disabled = true;
    document.getElementById('analysisStatus').innerHTML = '上传图片以开始...';
}

function deployAgent() {
    const name = document.getElementById('agentName').value;
    const personality = document.getElementById('agentPersonality').value;
    const imagePreview = document.getElementById('imagePreview');
    
    if (!name || !personality || !imagePreview.src) {
        alert('请填写所有字段并上传图片');
        return;
    }
    
    const newAgent = {
        id: Date.now(),
        name: name,
        image: imagePreview.src,
        description: personality,
        systemPrompt: `Respond as ${name} with personality: ${personality}`
    };
    
    const customAgents = JSON.parse(localStorage.getItem('customAgents') || '[]');
    customAgents.push(newAgent);
    localStorage.setItem('customAgents', JSON.stringify(customAgents));
    agents.push(newAgent);
    initializeAgents();
    closeCreator();
    alert('代理已成功创建！');
}

function openDeployModal(bot) {
    currentDeployBot = bot;
    document.getElementById('deployModal').style.display = 'block';
}

function closeDeployModal() {
    document.getElementById('deployModal').style.display = 'none';
    document.getElementById('botToken').value = '';
}

function deployBot() {
    const token = document.getElementById('botToken').value.trim();
    if (!token) {
        alert('请输入机器人令牌');
        return;
    }
    alert('Telegram部署目前不可用 - 请稍后再试！');
    closeDeployModal();
}

function openPumpModal(bot) {
    currentDeployBot = bot;
    document.getElementById('pumpModal').style.display = 'block';
    document.getElementById('pumpName').value = bot.name;
    document.getElementById('pumpDescription').value = bot.description;
    document.getElementById('pumpImage').src = bot.image;
}

function closePumpModal() {
    document.getElementById('pumpModal').style.display = 'none';
}

function deployToPump() {
    const ticker = document.getElementById('pumpTicker').value.trim();
    if (!ticker) {
        alert('请输入代币符号');
        return;
    }
    alert('pump部署目前不可用 - 请稍后再试！');
    closePumpModal();
}

function openSubdomainModal(bot) {
    currentDeployBot = bot;
    document.getElementById('subdomainModal').style.display = 'block';
}

function closeSubdomainModal() {
    document.getElementById('subdomainModal').style.display = 'none';
    document.getElementById('subdomainInput').value = '';
}

function deployToSubdomain() {
    const subdomain = document.getElementById('subdomainInput').value.trim();
    if (!subdomain) {
        alert('请输入子域名');
        return;
    }
    alert('子域名部署目前不可用 - 请稍后再试！');
    closeSubdomainModal();
}

window.onclick = function(event) {
    if (event.target.id === 'chatModal') closeChat();
    if (event.target.id === 'deployModal') closeDeployModal();
    if (event.target.id === 'pumpModal') closePumpModal();
    if (event.target.id === 'subdomainModal') closeSubdomainModal();
    if (event.target.id === 'creatorModal') closeCreator();
}

document.addEventListener('DOMContentLoaded', () => {
    initializeAgents();
    initializeCreator();
    
    const userInput = document.getElementById('userInput');
    if (userInput) {
        userInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') sendMessage();
        });
    }
});
    </script>
</body>
</html>









