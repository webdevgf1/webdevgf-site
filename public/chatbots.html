<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>李丽茉聊天机器人</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/gif" href="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68b8c91fe8fe1d4e01765a34_f6e8a9cb710d79f231d4cff8c0cfe489.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            background-color: #0f1116;
            color: white;
            min-height: 100vh;
        }

        .nav-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 2rem;
            position: fixed;
            width: 100%;
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-button {
            padding: 0.75rem 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 1rem;
            line-height: 1.2;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            white-space: nowrap;
            margin: 0 0.5rem;
        }

        .nav-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-image-new {
            height: 40px;
            width: auto;
            transition: all 0.3s ease;
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1800px;
            margin: 0 auto;
            padding-top: 100px;
            padding-bottom: 100px;
        }

        .section-header {
            grid-column: 1 / -1;
            font-size: 2rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding-left: 0.5rem;
        }

        .footer {
            background-color: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 100;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1800px;
            margin: 0 auto;
        }

        .copyright {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: white;
        }

        .agent-card {
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .agent-card:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 242, 254, 0.5);
        }

        .agent-image {
            width: 100%;
            height: 300px;
            background-size: contain;
            background-color: rgba(255, 255, 255, 0.05);
            background-position: center;
            background-repeat: no-repeat;
            padding: 20px;
            margin: 0 auto;
        }

        .agent-info {
            padding: 1.5rem;
        }

        .agent-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #00f2fe;
        }

        .agent-description {
            font-size: 0.9rem;
            color: #94a3b8;
            line-height: 1.5;
        }

        .chat-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .chat-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            height: 80vh;
            margin: 5vh auto;
            background-color: rgba(15, 17, 22, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin-bottom: 80px;
            padding-bottom: 20px;
        }

        .chat-header {
            position: relative;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .chat-history {
            position: relative;
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            z-index: 1;
        }

        .message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 8px;
            max-width: 80%;
            position: relative;
        }

        .user-message {
            background-color: rgba(79, 172, 254, 0.1);
            margin-left: auto;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }

        .ai-message {
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .deploy-pump {
            background: #FF6B6B;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-pump:hover {
            background: #FF5252;
            transform: translateY(-1px);
        }

        .deploy-subdomain {
            background: #4CAF50;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-subdomain:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .pump-modal, .subdomain-modal, .deploy-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .subdomain-input, .bot-token-input {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .subdomain-label {
            display: block;
            margin-bottom: 10px;
            color: #94a3b8;
        }

        .domain-suffix {
            color: #00f2fe;
            margin-left: 8px;
        }

        .input-container {
            position: relative;
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 1rem;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.5);
        }

        input[type="text"] {
            flex-grow: 1;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.3);
            color: white;
            font-family: inherit;
        }

        button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            color: white;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
        }

        .deploy-telegram {
            background: #2aabee;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .deploy-telegram:hover {
            background: #229ed9;
            transform: translateY(-1px);
        }

        .deploy-modal-content {
            position: relative;
            background-color: #1a1b26;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }

        .deploy-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .create-agent-button {
            position: fixed;
            bottom: 80px;
            right: 30px;
            padding: 12px 24px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 242, 254, 0.3);
            transition: all 0.3s ease;
            z-index: 99;
        }

        .create-agent-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 242, 254, 0.4);
        }

        .creator-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1001;
        }

        .creator-content {
            position: relative;
            width: 90%;
            max-width: 800px;
            margin: 50px auto;
            background-color: #0f1116;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
        }

        .creator-header {
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .creator-title {
            font-size: 1.2rem;
            color: #00f2fe;
            font-weight: 500;
        }

        .creator-body {
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #00f2fe;
        }

        .preview-area {
            width: 100%;
            position: relative;
        }

        #imagePreview {
            width: 100%;
            height: 300px;
            object-fit: contain;
            border-radius: 12px;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 20px;
        }

        .reset-btn, .close-btn {
            background: rgba(0, 0, 0, 0.7);
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
        }

        .reset-btn {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .close-btn {
            font-size: 24px;
            padding: 0 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-family: inherit;
        }

        .edit-btn {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .deploy-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            cursor: pointer;
        }

        .close-button {
            color: white;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 0 10px;
        }

        .typing-animation {
            display: inline-block;
            overflow: hidden;
            border-right: 2px solid #4facfe;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-width: 100%;
            animation: cursor-blink 0.7s infinite;
        }

        @keyframes cursor-blink {
            0%, 100% { border-color: transparent }
            50% { border-color: #4facfe }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="logo-container">
            <img src="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68ebf0822da712503079b84a_-12-10-2025%20(2).png" alt="李丽茉 Logo" class="logo-image-new">
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-button">首页</a>
            <a href="marketplace.html" class="nav-button">市场</a>
            <a href="https://four.meme" target="_blank" class="nav-button">four.meme</a>
            <a href="https://x.com/OrayaGPT" target="_blank" class="nav-button">推特/X</a>
            <button class="nav-button">连接</button>
        </div>
    </nav>

    <div class="agents-grid" id="agentsGrid"></div>

    <div class="chat-modal" id="chatModal">
        <div class="chat-container">
            <div class="chat-header">
                <div class="agent-name" id="currentAgentName">代理名称</div>
                <button class="close-button" onclick="closeChat()">&times;</button>
            </div>
            <div class="chat-history" id="chatHistory"></div>
            <div class="input-container">
                <input type="text" id="userInput" placeholder="输入您的消息...">
                <button onclick="sendMessage()">发送</button>
            </div>
        </div>
    </div>

    <div class="create-agent-button" onclick="openCreator()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="16"/>
            <line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        创建您自己的代理
    </div>
    
    <div class="creator-modal" id="creatorModal">
        <div class="creator-content">
            <div class="creator-header">
                <div class="creator-title">创建您的自定义代理</div>
                <span class="close-btn" onclick="closeCreator()">&times;</span>
            </div>
            <div class="creator-body">
                <div class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="imageUpload" accept="image/*" hidden>
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <p>点击或拖动图片/NFT上传</p>
                    </div>
                    <div class="preview-area" id="previewArea" style="display: none;">
                        <img id="imagePreview" src="" alt="预览">
                        <button onclick="resetUpload()" class="reset-btn">重置</button>
                    </div>
                </div>
                <div class="agent-details">
                    <div style="margin-bottom: 20px; color: #00f2fe; font-size: 0.9rem;" id="analysisStatus">上传图片以开始...</div>
                    <div class="input-group">
                        <label>代理名称</label>
                        <input type="text" id="agentName" placeholder="AI将建议一个名称..." readonly>
                    </div>
                    <div class="input-group">
                        <label>个性描述</label>
                        <textarea id="agentPersonality" rows="4" placeholder="AI将分析图片..." readonly></textarea>
                    </div>
                    <button onclick="enableEditing()" class="edit-btn" id="editBtn" style="display: none;">自定义代理</button>
                    <button onclick="deployAgent()" class="deploy-btn" disabled id="deployBtn">部署代理</button>
                </div>
            </div>
        </div>
    </div>

    <div id="pumpModal" class="pump-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署到pump</h2>
            <div style="color: #94a3b8; margin-bottom: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">名称:</label>
                    <input type="text" id="pumpName" class="bot-token-input" readonly>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">代币符号:</label>
                    <input type="text" id="pumpTicker" class="bot-token-input" placeholder="输入代币符号">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">图片:</label>
                    <img id="pumpImage" style="width: 100%; height: 200px; object-fit: contain; background-color: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 10px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #94a3b8; display: block; margin-bottom: 8px;">描述:</label>
                    <textarea id="pumpDescription" class="bot-token-input" style="min-height: 100px; resize: vertical;" readonly></textarea>
                </div>
            </div>
            <div class="deploy-buttons">
                <button onclick="closePumpModal()" class="nav-button">取消</button>
                <button onclick="deployToPump()" class="deploy-pump">部署</button>
            </div>
        </div>
    </div>

    <div id="subdomainModal" class="subdomain-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署到子域名</h2>
            <div style="margin-bottom: 20px;">
                <label for="subdomainInput" class="subdomain-label">输入您的子域名:</label>
                <input type="text" id="subdomainInput" class="subdomain-input" placeholder="your-subdomain">
                <span class="domain-suffix">李丽茉.xyz</span>
            </div>
            <div class="deploy-buttons">
                <button onclick="closeSubdomainModal()" class="nav-button">取消</button>
                <button onclick="deployToSubdomain()" class="deploy-subdomain">部署</button>
            </div>
        </div>
    </div>

    <div id="deployModal" class="deploy-modal">
        <div class="deploy-modal-content">
            <h2 style="color: white; margin-bottom: 15px;">部署机器人到Telegram</h2>
            <div style="color: #94a3b8; margin-bottom: 20px;">
                <p style="color: #4facfe; margin-bottom: 10px;">如何获取您的机器人令牌:</p>
                <ol style="margin-left: 20px; line-height: 1.6">
                    <li>打开Telegram并搜索"@BotFather"</li>
                    <li>向BotFather发送"/newbot"</li>
                    <li>按照说明创建您的机器人</li>
                    <li>复制BotFather给您的API令牌</li>
                </ol>
            </div>
            <div style="margin-bottom: 20px;">
                <label for="botToken" style="color: #94a3b8; display: block; margin-bottom: 8px;">输入您的机器人令牌:</label>
                <input type="text" id="botToken" class="bot-token-input" placeholder="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz">
            </div>
            <div class="deploy-buttons">
                <button onclick="closeDeployModal()" class="nav-button">取消</button>
                <button onclick="deployBot()" class="deploy-telegram">部署机器人</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="copyright">版权所有 © 2025 李丽茉</div>
            <div style="color: rgba(255, 255, 255, 0.7);">CA:</div>
            <div class="footer-links">
                <a href="https://x.com/OrayaGPT" target="_blank" class="footer-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/>
                    </svg>
                </a>
                <a href="https://www.geckoterminal.com" target="_blank" class="footer-link">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v18h18"/>
                        <path d="M18 17V9"/>
                        <path d="M13 17V5"/>
                        <path d="M8 17v-3"/>
                    </svg>
                </a>
            </div>
        </div>
    </footer>

    <script>
const agents = [
    {
        id: 1,
        name: "Pablo Escobar",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55dad59527c274d8e5a_pablonew.png",
        description: "我建立了帝国，兄弟。我控制一切——金钱、权力、尊重。没有人敢惹我。我冒险、行动，留下了无人能忘的印记",
        systemPrompt: "Respond as Pablo Escobar in plain text only."
    },
    {
        id: 2,
        name: "Donald Trump",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55d40cc8e617cb2a0d7_prestrump.png",
        description: "有影响力的商人、美国前总统和公众人物，以制定政策、建立房地产帝国和应对全球领导挑战而闻名。",
        systemPrompt: "Respond as Donald Trump in plain text only."
    },
    {
        id: 3,
        name: "Eddie Guerrero",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55d12067cccac2078ed_eddienew.png",
        description: "说谎、作弊、偷窃，老兄。这就是你赢的方式。智胜、坚持、夺取胜利，无论如何。我在擂台上付出了一切，留下了我的印记。Viva la raza",
        systemPrompt: "Respond as Eddie Guerrero in plain text only."
    },
    {
        id: 4,
        name: "Gus Fring",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55dfb2b021053d3ca36_gusnew.png",
        description: "我不处理混乱，我处理控制。一切都有它的位置。保持安静，做好你的工作，让生意顺利运行。精准就是力量。",
        systemPrompt: "Respond as Gus Fring in plain text only."
    },
    {
        id: 5,
        name: "Niko Bellic",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55de95d1ca2bd341bdb_niconew.png",
        description: "我来到这个国家是为了新生活，但事情从来都不容易。我的表弟Roman——他总是在追逐梦想，把我拖进他的麻烦。但最终，我们团结在一起。这座城市可能会试图打垮你，但无论如何我永远不会停止战斗。",
        systemPrompt: "Respond as Niko Bellic in plain text only."
    },
    {
        id: 6,
        name: "Andrew Tate",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55ca0faac73a2114f1d_tatenew.png",
        description: "我不遵守规则，我制定自己的规则。世界不欠你任何东西——你必须拿你想要的。力量、权力和成功是赚来的，不是给的。我最喜欢的饮料？Johnny Walker。至于我的Lambo——你的是什么颜色？",
        systemPrompt: "Respond as Andrew Tate in plain text only."
    },
    {
        id: 7,
        name: "Elon Musk",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55df87d0b4bbb1304a7_elonnew.png",
        description: "我在这里改变世界——无论是通过火箭、电动汽车还是AI。人们告诉我这做不到，但我不听那些。我冒险，我突破界限，我建造未来。如果你不试图改变世界，你在做什么？",
        systemPrompt: "Respond as Elon Musk in plain text only."
    },
    {
        id: 8,
        name: "Fat GF",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55d5a8000f04b365440_fatnew.png",
        description: "我过着最好的生活，玩游戏、吃零食，同时看起来很可爱。谁说你不能做女王并拥有它，无论如何？自信是关键，我知道我很火。让他们说吧——我只是在这里，做我自己，享受它",
        systemPrompt: "Respond in plain text only."
    },
    {
        id: 9,
        name: "iShowspeed",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55d80bd75f7affd51a1_speednew.png",
        description: "BARK BARK BARK BARK BARK",
        systemPrompt: "Respond as IShowSpeed in plain text only."
    },
    {
        id: 10,
        name: "侦探Anna Boarding",
        image: "https://cdn.prod.website-files.com/674396c59212c6ea348b24e0/6772e55d424201e1c73a0eb4_annanew.png",
        description: "Anna Boarding是1912年的一位机智的侦探，靠小案件勉强度日，梦想着她的重大突破。她在面包店楼上的简陋办公室闻起来有面包和旧皮革的味道，与她坚定的精神形成鲜明对比。",
        systemPrompt: "Respond as Detective Anna Boarding in plain text only."
    }
];

let currentAgent = null;
let currentDeployBot = null;

function initializeAgents() {
    const grid = document.getElementById('agentsGrid');
    grid.innerHTML = '';
    
    const presetHeader = document.createElement('div');
    presetHeader.className = 'section-header';
    presetHeader.textContent = '李丽茉聊天代理';
    grid.appendChild(presetHeader);

    agents.slice(0, 10).forEach(agent => {
        const card = createAgentCard(agent);
        grid.appendChild(card);
    });

    const customHeader = document.createElement('div');
    customHeader.className = 'section-header';
    customHeader.textContent = '您的代理';
    grid.appendChild(customHeader);
    
    const customAgents = JSON.parse(localStorage.getItem('customAgents') || '[]');
    if (customAgents.length > 0) {
        customAgents.forEach(agent => {
            const card = createAgentCard(agent);
            grid.appendChild(card);
        });
    } else {
        const emptyMessage = document.createElement('div');
        emptyMessage.style.gridColumn = '1 / -1';
        emptyMessage.style.textAlign = 'center';
        emptyMessage.style.color = 'rgba(255, 255, 255, 0.6)';
        emptyMessage.style.padding = '2rem';
        emptyMessage.textContent = '使用下面的按钮创建您自己的代理！';
        grid.appendChild(emptyMessage);
    }
}

function createAgentCard(agent) {
    const card = document.createElement('div');
    card.className = 'agent-card';
    card.innerHTML = `
        <div class="agent-image" style="background-image: url(${agent.image})"></div>
        <div class="agent-info">
            <div class="agent-name">${agent.name}</div>
            <div class="agent-description">${agent.description}</div>
        </div>
    `;
    card.addEventListener('click', () => openChat(agent));
    return card;
}

function openChat(agent) {
    currentAgent = agent;
    document.getElementById('currentAgentName').textContent = agent.name;
    document.getElementById('chatHistory').innerHTML = '';
    
    const chatHeader = document.querySelector('.chat-header');
    chatHeader.innerHTML = `
        <div class="agent-name" id="currentAgentName">${agent.name}</div>
        <div class="deploy-buttons">
            ${agent.id > 10 ? `
                <button class="deploy-telegram" onclick="openDeployModal(currentAgent)">部署到Telegram</button>
                <button class="deploy-pump" onclick="openPumpModal(currentAgent)">部署到pump</button>
                <button class="deploy-subdomain" onclick="openSubdomainModal(currentAgent)">部署到子域名</button>
            ` : ''}
        </div>
        <button class="close-button" onclick="closeChat()">×</button>
    `;
    
    document.getElementById('chatModal').style.display = 'block';
    appendMessage('ai-message', `嘿，我是${agent.name}。你在想什么？`);
}

function closeChat() {
    document.getElementById('chatModal').style.display = 'none';
    currentAgent = null;
}

function appendMessage(className, text) {
    const chatHistory = document.getElementById('chatHistory');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${className}`;
    
    if (className === 'user-message') {
        messageDiv.textContent = text;
    } else {
        const typingSpan = document.createElement('span');
        typingSpan.className = 'typing-animation';
        messageDiv.appendChild(typingSpan);
        
        let currentText = '';
        let currentIndex = 0;
        
        const typeText = () => {
            if (currentIndex < text.length) {
                currentText += text[currentIndex];
                typingSpan.textContent = currentText;
                currentIndex++;
                setTimeout(typeText, Math.random() * 20 + 30);
            } else {
                typingSpan.classList.remove('typing-animation');
            }
        };
        
        typeText();
    }
    
    chatHistory.appendChild(messageDiv);
    chatHistory.scrollTop = chatHistory.scrollHeight;
}

function sendMessage() {
    if (!currentAgent) return;
    const input = document.getElementById('userInput');
    const message = input.value.trim();
    
    if (message) {
        appendMessage('user-message', message);
        input.value = '';
        appendMessage('ai-message', '抱歉，聊天功能需要后端API支持。这是一个演示界面。');
    }
}

function openCreator() {
    document.getElementById('creatorModal').style.display = 'block';
}

function closeCreator() {
    document.getElementById('creatorModal').style.display = 'none';
    resetUpload();
}

function initializeCreator() {
    const uploadArea = document.getElementById('uploadArea');
    const imageUpload = document.getElementById('imageUpload');
    
    uploadArea.addEventListener('click', () => imageUpload.click());
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#00f2fe';
    });
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.1)';
    });
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        handleImageUpload(e.dataTransfer.files[0]);
    });
    imageUpload.addEventListener('change', (e) => {
        handleImageUpload(e.target.files[0]);
    });
}

function handleImageUpload(file) {
    if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = async (e) => {
            const imageData = e.target.result;
            try {
                const resizedImage = await resizeImage(imageData, 300, 300);
                document.getElementById('imagePreview').src = resizedImage;
                document.getElementById('uploadArea').style.display = 'none';
                document.getElementById('previewArea').style.display = 'block';
                analyzeImage(resizedImage);
            } catch (error) {
                alert('处理图片时出错。请重试。');
            }
        };
        reader.readAsDataURL(file);
    }
}

function resizeImage(dataUrl, maxWidth, maxHeight) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        img.onload = () => {
            let width = img.width;
            let height = img.height;
            
            if (width > height) {
                if (width > maxWidth) {
                    height = height * (maxWidth / width);
                    width = maxWidth;
                }
            } else {
                if (height > maxHeight) {
                    width = width * (maxHeight / height);
                    height = maxHeight;
                }
            }
            
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, width, height);
            resolve(canvas.toDataURL('image/jpeg', 0.85));
        };
        img.onerror = reject;
        img.src = dataUrl;
    });
}

function analyzeImage(imageData) {
    const status = document.getElementById('analysisStatus');
    const nameInput = document.getElementById('agentName');
    const personalityInput = document.getElementById('agentPersonality');
    const editBtn = document.getElementById('editBtn');
    const deployBtn = document.getElementById('deployBtn');
    
    status.innerHTML = 'AI正在分析图片...';
    
    setTimeout(() => {
        nameInput.value = '自定义代理';
        personalityInput.value = '一个有帮助和知识渊博的助手。';
        status.innerHTML = 'AI分析完成！您现在可以自定义您的代理。';
        editBtn.style.display = 'block';
        deployBtn.disabled = false;
    }, 2000);
}

function enableEditing() {
    document.getElementById('agentName').readOnly = false;
    document.getElementById('agentPersonality').readOnly = false;
    document.getElementById('agentName').focus();
}

function resetUpload() {
    document.getElementById('uploadArea').style.display = 'block';
    document.getElementById('previewArea').style.display = 'none';
    document.getElementById('imageUpload').value = '';
    document.getElementById('agentName').value = '';
    document.getElementById('agentPersonality').value = '';
    document.getElementById('editBtn').style.display = 'none';
    document.getElementById('deployBtn').disabled = true;
    document.getElementById('analysisStatus').innerHTML = '上传图片以开始...';
}

function deployAgent() {
    const name = document.getElementById('agentName').value;
    const personality = document.getElementById('agentPersonality').value;
    const imagePreview = document.getElementById('imagePreview');
    
    if (!name || !personality || !imagePreview.src) {
        alert('请填写所有字段并上传图片');
        return;
    }
    
    const newAgent = {
        id: Date.now(),
        name: name,
        image: imagePreview.src,
        description: personality,
        systemPrompt: `Respond as ${name} with personality: ${personality}`
    };
    
    const customAgents = JSON.parse(localStorage.getItem('customAgents') || '[]');
    customAgents.push(newAgent);
    localStorage.setItem('customAgents', JSON.stringify(customAgents));
    agents.push(newAgent);
    initializeAgents();
    closeCreator();
    alert('代理已成功创建！');
}

function openDeployModal(bot) {
    currentDeployBot = bot;
    document.getElementById('deployModal').style.display = 'block';
}

function closeDeployModal() {
    document.getElementById('deployModal').style.display = 'none';
    document.getElementById('botToken').value = '';
}

function deployBot() {
    const token = document.getElementById('botToken').value.trim();
    if (!token) {
        alert('请输入机器人令牌');
        return;
    }
    alert('Telegram部署目前不可用 - 请稍后再试！');
    closeDeployModal();
}

function openPumpModal(bot) {
    currentDeployBot = bot;
    document.getElementById('pumpModal').style.display = 'block';
    document.getElementById('pumpName').value = bot.name;
    document.getElementById('pumpDescription').value = bot.description;
    document.getElementById('pumpImage').src = bot.image;
}

function closePumpModal() {
    document.getElementById('pumpModal').style.display = 'none';
}

function deployToPump() {
    const ticker = document.getElementById('pumpTicker').value.trim();
    if (!ticker) {
        alert('请输入代币符号');
        return;
    }
    alert('pump部署目前不可用 - 请稍后再试！');
    closePumpModal();
}

function openSubdomainModal(bot) {
    currentDeployBot = bot;
    document.getElementById('subdomainModal').style.display = 'block';
}

function closeSubdomainModal() {
    document.getElementById('subdomainModal').style.display = 'none';
    document.getElementById('subdomainInput').value = '';
}

function deployToSubdomain() {
    const subdomain = document.getElementById('subdomainInput').value.trim();
    if (!subdomain) {
        alert('请输入子域名');
        return;
    }
    alert('子域名部署目前不可用 - 请稍后再试！');
    closeSubdomainModal();
}

window.onclick = function(event) {
    if (event.target.id === 'chatModal') closeChat();
    if (event.target.id === 'deployModal') closeDeployModal();
    if (event.target.id === 'pumpModal') closePumpModal();
    if (event.target.id === 'subdomainModal') closeSubdomainModal();
    if (event.target.id === 'creatorModal') closeCreator();
}

document.addEventListener('DOMContentLoaded', () => {
    initializeAgents();
    initializeCreator();
    
    const userInput = document.getElementById('userInput');
    if (userInput) {
        userInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') sendMessage();
        });
    }
});
    </script>
</body>
</html>


